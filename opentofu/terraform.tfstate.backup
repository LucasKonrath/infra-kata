{"version":4,"terraform_version":"1.10.5","serial":4,"lineage":"53a8cb52-4777-6395-ea5e-1e24364908d2","outputs":{"apps_namespace":{"value":"apps","type":"string"},"grafana_url_hint":{"value":"Run: kubectl -n infra port-forward svc/kube-prometheus-stack-grafana 3000:80","type":"string"},"infra_namespace":{"value":"infra","type":"string"},"jenkins_url_hint":{"value":"Run: kubectl -n infra port-forward svc/jenkins 8080:8080","type":"string"}},"resources":[{"mode":"managed","type":"helm_release","name":"kube_prometheus_stack","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"kube-prometheus-stack","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"kube-prometheus-stack","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"v0.75.1","chart":"kube-prometheus-stack","first_deployed":1755093651,"last_deployed":1755093651,"name":"kube-prometheus-stack","namespace":"infra","notes":"1. Get your 'admin' user password by running:\n\n   kubectl get secret --namespace infra kube-prometheus-stack-grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n\n\n2. The Grafana server can be accessed via port 80 on the following DNS name from within your cluster:\n\n   kube-prometheus-stack-grafana.infra.svc.cluster.local\n\n   Get the Grafana URL to visit by running these commands in the same shell:\n     export POD_NAME=$(kubectl get pods --namespace infra -l \"app.kubernetes.io/name=grafana,app.kubernetes.io/instance=kube-prometheus-stack\" -o jsonpath=\"{.items[0].metadata.name}\")\n     kubectl --namespace infra port-forward $POD_NAME 3000\n\n3. Login with the password from step 1 and the username: admin\n#################################################################################\n######   WARNING: Persistence is disabled!!! You will lose your data when   #####\n######            the Grafana pod is terminated.                            #####\n#################################################################################\n\nkube-prometheus-stack has been installed. Check its status by running:\n  kubectl --namespace infra get pods -l \"release=kube-prometheus-stack\"\n\nVisit https://github.com/prometheus-operator/kube-prometheus for instructions on how to create \u0026 configure Alertmanager and Prometheus instances using the Operator.\n\nkube-state-metrics is a simple service that listens to the Kubernetes API server and generates metrics about the state of the objects.\nThe exposed metrics can be found here:\nhttps://github.com/kubernetes/kube-state-metrics/blob/master/docs/README.md#exposed-metrics\n\nThe metrics are exported on the HTTP endpoint /metrics on the listening port.\nIn your case, kube-prometheus-stack-kube-state-metrics.infra.svc.cluster.local:8080/metrics\n\nThey are served either as plaintext or protobuf depending on the Accept header.\nThey are designed to be consumed either by Prometheus itself or by a scraper that is compatible with scraping a Prometheus client endpoint.\n\n1. Get the application URL by running these commands:\n  export POD_NAME=$(kubectl get pods --namespace infra -l \"app.kubernetes.io/name=prometheus-node-exporter,app.kubernetes.io/instance=kube-prometheus-stack\" -o jsonpath=\"{.items[0].metadata.name}\")\n  echo \"Visit http://127.0.0.1:9100 to use your application\"\n  kubectl port-forward --namespace infra $POD_NAME 9100","revision":1,"values":"{\"alertmanager\":{\"enabled\":false},\"grafana\":{\"adminPassword\":\"prom-operator\",\"defaultDashboardsEnabled\":true,\"sidecar\":{\"dashboards\":{\"enabled\":true},\"datasources\":{\"enabled\":true}}},\"prometheus\":{\"prometheusSpec\":{\"podMonitorSelectorNilUsesHelmValues\":false,\"resources\":{\"limits\":{\"cpu\":1,\"memory\":\"1Gi\"},\"requests\":{\"cpu\":\"200m\",\"memory\":\"512Mi\"}},\"retention\":\"24h\",\"serviceMonitorSelectorNilUsesHelmValues\":false}}}","version":"61.3.1"}],"name":"kube-prometheus-stack","namespace":"infra","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://prometheus-community.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["prometheus:\n  prometheusSpec:\n    podMonitorSelectorNilUsesHelmValues: false\n    serviceMonitorSelectorNilUsesHelmValues: false\n    retention: 24h\n    resources:\n      requests:\n        cpu: 200m\n        memory: 512Mi\n      limits:\n        cpu: 1\n        memory: 1Gi\nalertmanager:\n  enabled: false\ngrafana:\n  adminPassword: prom-operator\n  defaultDashboardsEnabled: true\n  sidecar:\n    dashboards:\n      enabled: true\n    datasources:\n      enabled: true\n"],"verify":false,"version":"61.3.1","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["kubernetes_namespace.infra"]}]},{"mode":"managed","type":"kubernetes_namespace","name":"apps","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"schema_version":0,"attributes":{"id":"apps","metadata":[{"annotations":{},"generate_name":"","generation":0,"labels":{},"name":"apps","resource_version":"776","uid":"54f69313-84a9-491a-8c31-40c0693a6a68"}],"timeouts":null,"wait_for_default_service_account":false},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="}]},{"mode":"managed","type":"kubernetes_namespace","name":"infra","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"schema_version":0,"attributes":{"id":"infra","metadata":[{"annotations":{},"generate_name":"","generation":0,"labels":{},"name":"infra","resource_version":"775","uid":"827fcc4b-80ca-4db1-bdbd-5517823ea549"}],"timeouts":null,"wait_for_default_service_account":false},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="}]}],"check_results":null}
